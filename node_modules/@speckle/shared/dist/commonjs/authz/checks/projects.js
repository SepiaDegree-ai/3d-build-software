"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requireMinimumProjectRoleFactory = exports.requireExactProjectVisibilityFactory = void 0;
const index_js_1 = require("../../core/index.js");
const errors_js_1 = require("../domain/errors.js");
const logic_js_1 = require("../domain/projects/logic.js");
const requireExactProjectVisibilityFactory = ({ loaders }) => async (args) => {
    const { projectId, projectVisibility } = args;
    const project = await loaders.getProject({ projectId });
    if (!project)
        throw new errors_js_1.ProjectNotFoundError({ projectId });
    switch (projectVisibility) {
        case 'linkShareable':
            return project.isDiscoverable === true;
        case 'public':
            return project.isPublic === true;
        case 'private':
            return project.isPublic !== true && project.isDiscoverable !== true;
        default:
            (0, index_js_1.throwUncoveredError)(projectVisibility);
    }
};
exports.requireExactProjectVisibilityFactory = requireExactProjectVisibilityFactory;
const requireMinimumProjectRoleFactory = ({ loaders }) => async (args) => {
    const { userId, projectId, role: requiredProjectRole } = args;
    const userProjectRole = await loaders.getProjectRole({ userId, projectId });
    return userProjectRole
        ? (0, logic_js_1.isMinimumProjectRole)(userProjectRole, requiredProjectRole)
        : false;
};
exports.requireMinimumProjectRoleFactory = requireMinimumProjectRoleFactory;
//# sourceMappingURL=projects.js.map